# vim基本命令

## 编辑命令

| 文本对象               | 更改  | 删除  | 复制   |
| ---------------------- | ----- | ----- | ------ |
| 一个单词               | cw    | dw    | yw     |
| 两个单词（不包含括号） | 2cW   | 2dW   | 2yW    |
| 后退三个单词           | 3cb   | 3db   | 3yb    |
| 一整行                 | cc    | dd    | yy或Y  |
| 到一行结尾             | c$或C | d$或D | y$     |
| 到一行开头             | c0    | d0    | y0     |
| 单个字符               | r     | x或X  | yl或yh |
| 五个字符               | 5s    | 5x    | 5yl    |

## 光标移动命令

| 移动             | 命令       |
| ---------------- | ---------- |
| 左、下、上、右   | h、j、k、l |
| 下一行第一个字符 | +          |
| 上一行第一个字符 | -          |
| 到单词结尾       | e或E       |
| 往前一个单词     | w或W       |
| 往后一个单词     | b或B       |
| 到一行到结尾     | $          |
| 到一行到开头     | 0          |

## 文本创建与操纵命令

| 编辑动作                                       | 命令 |
| ---------------------------------------------- | ---- |
| 光标所在位置插入文本（闪烁前方）               | i    |
| 一行到开头插入文本                             | I    |
| 光标所在位置附加文本（闪烁后方）               | a    |
| 一行的末尾附加文本                             | A    |
| 光标下一行打开新行插入文本                     | o    |
| 光标上一行打开新行插入文本                     | O    |
| 删除一行并替换文本                             | S    |
| 用新文本覆盖现有文本                           | R    |
| 合并当前行与下一行（将下一行移动到当前行后面） | J    |
| 切换大小写（当前字符）                         | ～   |
| 重复上一个动作                                 | .    |
| 撤销上一个动作                                 | u    |
| 将一整行恢复到原来的状态                       | U    |

注意：

​	S-----删除一行，然后输入文本

​	R-----逐个替代的删除该行文本

## 其他操作

| 操作                            | 命令     |
| ------------------------------- | -------- |
| 往缓冲区放置文本                | p或P     |
| 打开vi                          | vi  file |
| 保存编辑结果，离开文件          | shift+ZZ |
| 不保存结果，离开文件 (强制退出) | :q!      |

## 移动命令

### 屏幕移动

| 移动                         | 命令   |
| ---------------------------- | ------ |
| 往前移动一屏幕               | ^+f    |
| 往后移动一屏幕               | ^+b    |
| 往前移动半屏幕               | ^+d    |
| 往后移动半屏幕               | ^+u    |
| 往前滚动一行                 | ^+e    |
| 往后滚动一行                 | ^+y    |
| 移动到屏幕顶端               | H      |
| 移动到屏幕中间               | M      |
| 移动到屏幕底端               | L      |
| 将当前行移动到顶端并滚动屏幕 | z+回车 |
| 将当前行移动到中心并滚动屏幕 | z.     |
| 将当前行移动到底端并滚动屏幕 | z-     |

好用的组合：

​	5z+回车「-----将第5行移动到屏幕顶端」

​	55z.「-----将第55行移动到屏幕中心」

​	15z-「-----将第15行移动到屏幕底端」

​	2H「-----移动到屏幕顶端向下第2行」

​	5L「-----移动到屏幕底端向上第5行」

### 搜索移动

| 移动                                      | 命令     |
| ----------------------------------------- | -------- |
| 往前搜索                                  | /pattern |
| 往后搜索                                  | ?pattern |
| 向同一个方向重复搜索                      | n        |
| 反方向重复搜索                            | N        |
| 往前重复搜索                              | /+回车   |
| 往后重复搜索                              | ？+回车  |
| 搜索当前行中下一个出现x的地方             | fx       |
| 搜索当前行中上一个出现x的地方             | Fx       |
| 搜索当前行中下一个出现x的地方的前一个字符 | tx       |
| 搜索当前行中上一个出现x的地方的后一个字符 | Tx       |
| 重复上一个搜索命令，方向相同              | ;        |
| 重复上一个搜索命令，方向相反              | ,        |

通过搜索修改文本：

​	d?java	「从光标位置开始，向前删除到出现java的地方（包括java）」

### 跳转移动

| 移动                         | 命令   |
| ---------------------------- | ------ |
| 转至第n行                    | nG     |
| 转至文件结尾                 | G      |
| 回到上一个记号或者上下文     | ``     |
| 回到上一个记号的行开头处     | ''     |
| 显示当前行信息               | ctrl+g |
| 移动到当前句子开头           | (      |
| 移动到下一个句子开头         | )      |
| 移动到当前段开头             | {      |
| 移动到下一段开头             | }      |
| 移动到当前节的开头           | [[     |
| 移动到下一节的开头           | ]]     |
| 移动到当前行第一个非空格字符 | ^      |
| 移动到当前行的第n个字符      | n\|    |

句子的结束：

1. vim会寻找？、.、！这些标点符号，以辨认句子的结束。
2. 当这些符号后面有至少两个空格 或 作为一行中最后一个非空字符时认定为句子结束。
3. 如果句子后面只留了一个空格 或 引号结束，则不能辨认为句子结束。

段落的结束：

1. ​	空白行

   ​																									

# 全局替换

主要使用两个ex命令：

1. g（global，全局）
2. s（sbustitute，替换）

## 基本替换

| 动作                             | 命令               |
| -------------------------------- | ------------------ |
| 将当前行第一个出现的old改为new   | :s/old/new/        |
| 将这一行中每一个old替换为new     | :s/old/new/g       |
| 将50-100行之间每一个old替换为new | :50,100s/old/new/g |
| 同下（1,\$s=%s）                 | :1,$s/old/new/g    |
| 将整个文件每一行old替换为new     | :%s/old/new/g      |

## 确认替换

- 我们常常会在替换发生之后，发现替换结果有误，需要撤销。

1. 通过u，撤销上一次替换。
2. 替换之前通过 :w 写入文件，需要替换时，使用:q!不保存退出。
3. 也可以使用 :e! 读出上一个版本的缓冲区内容。（即撤销到上个版本）



- **除此之外，vim编辑器提供了一种<u>确认替换---c选项（confirm）</u>**

| 动作           | 命令           |
| -------------- | -------------- |
| 在替换之前询问 | :%s/old/new/gc |

此时，如果存在多个替换选项，编辑器会逐个询问

1. y，代表本次替换
2. n，代表本次不替换
3. a，替换符合的所有
4. q，退出（不替换）
5. l，替换本次并退出



- 一个技巧

  使用n（重复上一次搜索）、点号（.）（重复上一次命令）结合进行局部替换。

  | 命令      | 行为             |
  | --------- | ---------------- |
  | /old      | 搜索old          |
  | cwnew+ESC | 替换old为new     |
  | n         | 重复搜索         |
  | .         | 重复命令（替换） |

  注意：

  ​	遇到不需要替换的old，直接按n跳到下一个搜索结果即可。

  ​	cwnew：表示c、w、new，修改、一个单词、单词拼写new

## 上下文相关的替换

解释：找到包含模式的某一行时，对另外一个字符串进行替换。

| 命令                   | 行为                                                         |
| ---------------------- | ------------------------------------------------------------ |
| :g/pattern/s/old/new/g | （第一个g）对文件所有行起作用，在出现pattern的行发生替换，将old替换称为new，将这一行所有old都替换（最后一个g） |

注意：

​	第一个g，表示对所有行都起作用。

​	最后一个g，表示在行中进行全局替换。（没有这个g，只替换匹配行中的第一个）



| 命令               | 行为                                                         |
| ------------------ | ------------------------------------------------------------ |
| :g/string/s//new/g | 包含string的行中，相同的字符串string做替换。(全部string都替换) |
| :%s/string/new/g   | 与上一句作用相同（意义相同）                                 |

